---
title: Z变换
author: 王大大
date: 2024/10/10 23:21
categories:
 - 信号与系统
tags:
 - 信号与系统
---
## Z 变换简介

**Z 变换**（Z-Transform）是数字信号处理和离散时间系统分析中的一种重要工具。它将离散时间信号从时间域转换到复频域，便于分析和处理信号的频谱特性、系统稳定性以及解决差分方程等问题。

### 1. Z 变换的定义

对于一个离散时间信号 $x[n]$，其 Z 变换定义为：
$$
    X(z) = \sum_{n=-\infty}^{+\infty} x[n] z^{-n}
$$
其中：
- $z$ 是一个复数变量，通常表示为 $z = re^{j\omega}$。
- $X(z)$ 是 $x[n]$ 的 Z 变换。
- $n$ 是时间索引，通常为整数。

在实际应用中，常考虑因果信号（即 $x[n] = 0$ 对于 $n < 0$），此时 Z 变换简化为：
$$
    X(z) = \sum_{n=0}^{+\infty} x[n] z^{-n}
$$
### 2. 收敛域

Z 变换的收敛域（Region of Convergence, ROC）是指使上述级数收敛的 $z$ 平面的区域。收敛域的确定对于系统分析和逆 Z 变换至关重要。

### 3. 常见的 Z 变换对

以下是一些常见信号及其 Z 变换：

- **单位脉冲信号** $\delta[n]$：
$$
    \mathcal{Z}\{\delta[n]\} = 1
$$
- **单位阶跃信号** $u[n]$：
$$
    \mathcal{Z}\{u[n]\} = \frac{1}{1 - z^{-1}}, \quad |z| > 1
$$
- **指数信号** $a^n u[n]$：
$$
    \mathcal{Z}\{a^n u[n]\} = \frac{1}{1 - a z^{-1}}, \quad |z| > |a|
$$
- **延迟信号** $x[n - k]$：
$$
    \mathcal{Z}\{x[n - k]\} = z^{-k} X(z), \quad k \geq 0
$$
### 4. Z 变换的性质

Z 变换具有多种有用的性质，常用于简化计算和分析：

- **线性性质**：
$$
    \mathcal{Z}\{a x[n] + b y[n]\} = a X(z) + b Y(z)
$$
- **时间移动**：
$$
    \mathcal{Z}\{x[n - k]\} = z^{-k} X(z)
$$
- **收敛域移动**：
$$
    \mathcal{Z}\{x[n] z_0^{-n}\} = X\left(\frac{z}{z_0}\right)
$$
- **微分性质（差分方程求解）**：
  对于差分方程，可以通过 Z 变换将时间域的差分方程转化为代数方程，便于求解。

- **卷积性质**：
$$
    \mathcal{Z}\{x[n] * y[n]\} = X(z) Y(z)
$$
其中，*表示卷积运算。

### 5. 应用领域

Z 变换广泛应用于以下领域：

- **数字滤波器设计**：通过分析滤波器的 Z 变换，可以设计出满足特定频率响应的数字滤波器。

- **系统稳定性分析**：通过检查系统的极点位置和收敛域，判断系统是否稳定。

- **差分方程求解**：利用 Z 变换将差分方程转化为代数方程，简化求解过程。

- **频谱分析**：分析信号的频域特性，了解其频谱分布。

### 6. 逆 Z 变换

逆 Z 变换用于将复频域的表达式转换回时间域信号。常用的方法包括：

- **部分分式分解法**：将 $X(z)$ 分解为简单分式，逐项求逆变换。

- **幂级数展开法**：将 $X(z)$ 表达为幂级数形式，直接匹配时间域信号。

- **留数定理**：利用复变函数的留数定理，通过积分路径求逆变换。
逆 Z 变换是信号处理和系统分析中将复频域表达式 $X(z)$ 转换回时间域信号 $x[n]$ 的重要工具。常用的逆 Z 变换方法包括部分分式分解法、幂级数展开法和留数定理。以下将详细讲解每种方法，并通过具体例子加以说明。

---

#### 1. **部分分式分解法**

##### 方法讲解

部分分式分解法适用于将 $X(z)$ 分解为若干简单的分式，每个分式对应一个已知的逆 Z 变换对。这种方法特别适用于 $X(z)$ 是一个有理函数（即分子和分母都是多项式）的情况。具体步骤如下：

1. **因式分解分母**：将分母多项式因式分解为一阶或二阶不可约因式。
2. **表达为部分分式**：根据因式分解的结果，将 $X(z)$ 表达为若干简单分式的和。
3. **确定系数**：通过代数方法（如比较系数法）确定各部分分式的系数。
4. **查表求逆变换**：利用已知的逆 Z 变换对，将每个部分分式转换为时间域信号，最后将它们相加得到 $x[n]$。

##### 具体例子

**例题**：求 $X(z) = \frac{z}{(z-0.5)(z-2)}$ 的逆 Z 变换。

**解答**：

1. **部分分式分解**：

首先将 $X(z)$ 表达为部分分式的形式：
$$
    \frac{z}{(z-0.5)(z-2)} = \frac{A}{z-0.5} + \frac{B}{z-2}
$$
2. **确定系数**：

乘以分母 $(z-0.5)(z-2)$：
$$
    z = A(z - 2) + B(z - 0.5)
$$
展开并收集同类项：
$$
    z = (A + B)z - (2A + 0.5B)
$$
比较系数：
$$
    \begin{cases}
    A + B = 1 \\
    -2A - 0.5B = 0
    \end{cases}
$$
解方程组：

从第一个方程得 $B = 1 - A$。

代入第二个方程：
$$
    -2A - 0.5(1 - A) = 0 \\
    -2A - 0.5 + 0.5A = 0 \\
    -1.5A = 0.5 \\
    A = -\frac{1}{3}
$$
则 $B = 1 - (-\frac{1}{3}) = \frac{4}{3}$。

因此：
$$
    \frac{z}{(z-0.5)(z-2)} = -\frac{1}{3} \cdot \frac{1}{z - 0.5} + \frac{4}{3} \cdot \frac{1}{z - 2}
$$
3. **查表求逆变换**：

已知 $\mathcal{Z}^{-1}\left\{ \frac{1}{z - a} \right\} = a^n u[n]$，其中 $u[n]$ 是单位阶跃序列。

因此：
$$
    x[n] = -\frac{1}{3} \cdot (0.5)^n u[n] + \frac{4}{3} \cdot 2^n u[n]
$$
或者：
$$
    x[n] = \left( \frac{4}{3} \cdot 2^n - \frac{1}{3} \cdot 0.5^n \right) u[n]
$$
---

#### 2. 幂级数展开法

##### 方法讲解

幂级数展开法通过将 $X(z)$ 表达为 $z^{-1}$ 的幂级数形式，从而直接匹配时间域信号 $x[n]$。这种方法适用于 $X(z)$ 可以展开为收敛的幂级数，并且每一项的系数对应时间域信号的值。

具体步骤如下：

1. **表达式重写**：将 $X(z)$ 以 $z^{-1}$ 为变量重写，适合展开为幂级数。
2. **展开幂级数**：利用已知的幂级数展开方法（如几何级数展开）将 $X(z)$ 展开为 $z^{-1}$ 的幂级数。
3. **匹配系数**：幂级数的系数即为 $x[n]$。

##### 具体例子

**例题**：求 $X(z) = \frac{1}{1 - 0.8z^{-1}}$ 的逆 Z 变换。

**解答**：

1. **表达式重写**：
$$
    X(z) = \frac{1}{1 - 0.8z^{-1}}
$$
2. **展开幂级数**：

这是一个几何级数，可以展开为：
$$
    X(z) = 1 + 0.8z^{-1} + (0.8)^2 z^{-2} + (0.8)^3 z^{-3} + \cdots
$$
该级数在 $|z| > 0.8$ 时收敛。

3. **匹配系数**：

根据幂级数展开，时间域信号为：
$$
    x[n] = 0.8^n u[n]
$$
即：
$$
    x[0] = 1, \quad x[1] = 0.8, \quad x[2] = 0.64, \quad \ldots
$$
---

#### 3. 留数定理

##### 方法讲解

留数定理是一种利用复变函数积分的方法，通过计算 $X(z)$ 在其极点处的留数来求得逆 Z 变换。具体步骤如下：

1. **确定极点**：找到 $X(z)$ 的所有极点。
2. **计算留数**：对于每个极点 $z_k$，计算 $\text{Res}\{X(z)z^{n-1}, z_k\}$。
3. **求和**：将所有极点的留数相加，得到 $x[n]$。

数学表达式为：
$$
    x[n] = \sum_{k} \text{Res}\{X(z)z^{n-1}, z_k\}
$$
##### 具体例子

**例题**：求 $X(z) = \frac{z}{z^2 - 1.5z + 0.7}$ 的逆 Z 变换。

**解答**：

1. **确定极点**：

首先求解分母的极点：
$$
    z^2 - 1.5z + 0.7 = 0
$$
求根：
$$
    z = \frac{1.5 \pm \sqrt{(1.5)^2 - 4 \cdot 1 \cdot 0.7}}{2} = \frac{1.5 \pm \sqrt{2.25 - 2.8}}{2} = \frac{1.5 \pm \sqrt{-0.55}}{2}
$$
因为出现了虚数根，表明系统有复数极点。设：
$$
    z = \frac{1.5}{2} \pm j \frac{\sqrt{0.55}}{2} = 0.75 \pm j 0.3717
$$
2. **计算留数**：

因为极点是共轭的，我们可以利用共轭对的性质来简化计算。

一般来说，对于每个极点 $z_k$，留数可以通过以下公式计算：
$$
    \text{Res}\{X(z)z^{n-1}, z_k\} = \frac{z_k \cdot z_k^{n-1}}{(z_k - z_{k'} )} \quad \text{其中} \quad z_{k'} \text{是另一极点}
$$
但是更简便的方法是利用部分分式的方法，但由于本例极点为复数，我们可以采用以下方法：

对于系统具有两个共轭极点 $z_1 = re^{j\theta}$ 和 $z_2 = re^{-j\theta}$，逆 Z 变换通常可以表示为：
$$
    x[n] = r^n \left( A \cos(n\theta) + B \sin(n\theta) \right) u[n]
$$
为了求出系数 $A$ 和 $B$，我们可以使用留数定理或其他方法。这里我们使用通用的方法进行说明。

3. **求和**：

由于具体留数计算较为复杂，这里以系统的标准二阶系统为例进行简化说明。假设：
$$
    X(z) = \frac{z}{(z - z_1)(z - z_2)}
$$
则逆 Z 变换为：
$$
    x[n] = \frac{z_1}{z_1 - z_2} z_1^{n-1} + \frac{z_2}{z_2 - z_1} z_2^{n-1}
$$
将 $z_1 = 0.75 + j0.3717$ 和 $z_2 = 0.75 - j0.3717$ 代入：
$$
    x[n] = \frac{0.75 + j0.3717}{(0.75 + j0.3717) - (0.75 - j0.3717)} (0.75 + j0.3717)^{n-1} + \frac{0.75 - j0.3717}{(0.75 - j0.3717) - (0.75 + j0.3717)} (0.75 - j0.3717)^{n-1}
$$
计算系数：
$$
    \frac{0.75 + j0.3717}{2j0.3717} = \frac{0.75}{2j0.3717} + \frac{j0.3717}{2j0.3717} = \frac{0.75}{2j0.3717} + \frac{1}{2}
$$
结合共轭对，可以将结果表示为：
$$
    x[n] = |z_1|^n \left( C \cos(n\theta) + D \sin(n\theta) \right) u[n]
$$
其中 $|z_1| = \sqrt{0.75^2 + 0.3717^2} \approx 0.832$，$\theta = \tan^{-1}\left(\frac{0.3717}{0.75}\right) \approx 0.448$ 弧度。

最终得到：
$$
    x[n] \approx 0.832^n \left( C \cos(0.448n) + D \sin(0.448n) \right) u[n]
$$
具体的 $C$ 和 $D$ 需要通过进一步的代数运算确定，但这里展示了利用留数定理得到逆 Z 变换的一般步骤。

---

以上三种方法各有优缺点：

- **部分分式分解法**适用于有理函数，步骤明确，但需要分母因式分解。
- **幂级数展开法**适用于可以展开为幂级数的表达式，计算简单，但可能需要复杂的级数展开。
- **留数定理**适用于复杂的 $X(z)$，尤其是具有复数极点的情况，但涉及复变函数的积分计算，步骤较为复杂。




### 7. 示例

**示例**：求序列 $x[n] = a^n u[n]$ 的 Z 变换。

**解**：

根据定义，
$$
    X(z) = \sum_{n=0}^{+\infty} a^n z^{-n} = \sum_{n=0}^{+\infty} \left(\frac{a}{z}\right)^n
$$
这是一个几何级数，当 $\left|\frac{a}{z}\right| < 1$ 时收敛，即 $|z| > |a|$。

利用几何级数求和公式，
$$
X(z) = \frac{1}{1 - \frac{a}{z}} = \frac{z}{z - a}, \quad |z| > |a|
$$

## Z 变换与傅里叶变换的比较

**Z 变换**和**傅里叶变换**（Fourier Transform）都是信号处理和系统分析中重要的工具。它们都将时域信号转换到频域，以便于分析信号的频谱特性和系统的响应。然而，两者在定义、应用范围、性质等方面存在显著差异。以下是对两者的详细比较：

### 1. **定义与基本概念**

- **傅里叶变换（Fourier Transform）**

傅里叶变换用于将时域信号转换到连续频域。对于离散时间信号，通常使用**离散时间傅里叶变换**（DTFT）定义为：
$$
    X(e^{j\omega}) = \sum_{n=-\infty}^{+\infty} x[n] e^{-j\omega n}
$$
其中，$\omega$ 为频率变量，取值范围通常为 $-\pi$ 到 $\pi$。

- **Z 变换（Z-Transform）**

Z 变换是傅里叶变换的推广，将离散时间信号转换到复频域。其定义为：
$$
    X(z) = \sum_{n=-\infty}^{+\infty} x[n] z^{-n}
$$
其中，$z$ 是复数变量，通常表示为 $z = re^{j\omega}$，其中 $r$ 是模，$\omega$ 是角频率。

### 2. **定义域与频域**

- **傅里叶变换**

- **定义域**：时域信号。
  - **频域**：单位圆上的频率响应，$|z| = 1$，即 $z = e^{j\omega}$。
  - **适用范围**：主要用于分析信号的频谱特性。

- **Z 变换**

- **定义域**：时域信号。
  - **频域**：整个复平面，包含幅度和相位信息。
  - **适用范围**：不仅可以分析频谱，还能用于系统的稳定性分析、差分方程求解等。

### 3. **收敛域（Region of Convergence, ROC）**

- **傅里叶变换**

- 实际上是 Z 变换在单位圆上的一种特殊情况。
  - 仅在单位圆上收敛，因此不涉及更广泛的收敛域概念。

- **Z 变换**

- 收敛域是 Z 变换分析中一个关键概念，决定了变换的有效性。
  - ROC 的不同区域对应不同的信号性质（如因果、反因果、双边）。

### 4. **应用领域**

- **傅里叶变换**

- **频谱分析**：分析信号的频率成分。
  - **滤波器设计**：设计和分析滤波器的频率响应。
  - **通信系统**：信号的调制与解调。

- **Z 变换**

- **系统分析**：分析离散时间系统的稳定性和响应。
  - **数字滤波器设计**：设计 IIR 和 FIR 滤波器。
  - **差分方程求解**：将时域差分方程转化为代数方程进行求解。
  - **控制系统**：离散控制系统的设计与分析。

### 5. **数学性质**

- **傅里叶变换**

- **线性性质**：与 Z 变换类似。
  - **时移性质**：信号的时移对应频域的相位变化。
  - **频移性质**：信号的频移对应时域的调制。
  - **卷积性质**：时域卷积对应频域的乘积。

- **Z 变换**

- 除了傅里叶变换具备的所有性质外，还具有更广泛的性质，如**极点与零点分析**、**收敛域移动**等。
  - **卷积性质**：与傅里叶变换类似，但在复频域内进行。

### 6. **极点与零点**

- **傅里叶变换**

- 主要关注频率响应，不直接涉及极点与零点的概念。
  - 频率响应可以视为 Z 变换在单位圆上的值。

- **Z 变换**

- 极点和零点是 Z 变换分析的重要部分，用于描述系统的稳定性和频率响应。
  - 系统的极点位置决定了系统的稳定性（所有极点必须位于 ROC 内）。

### 7. **逆变换**

- **傅里叶变换**

- 逆傅里叶变换将频域信号转换回时域。
  - 主要通过积分（连续）或离散求和（DTFT）实现。

- **Z 变换**

- 逆 Z 变换将复频域信号转换回时域。
  - 常用方法包括部分分式分解法、幂级数展开法和留数定理。

### 8. **关系与联系**

- **傅里叶变换**可以视为**Z 变换**在单位圆 $|z| = 1$ 上的特例。

即：
$$
    X(e^{j\omega}) = X(z) \big|_{z = e^{j\omega}}
$$
- **Z 变换**提供了更广泛的分析工具，通过调整 $|z|$ 可以分析信号在不同模值下的行为，而傅里叶变换仅关注 $|z| = 1$ 的情况。

### 9. **示例比较**

假设有一个因果信号 $x[n] = a^n u[n]$，其中 $|a| < 1$。

- **傅里叶变换**：
$$
    X(e^{j\omega}) = \sum_{n=0}^{+\infty} a^n e^{-j\omega n} = \frac{1}{1 - a e^{-j\omega}}, \quad |a| < 1
$$
- **Z 变换**：
$$
    X(z) = \sum_{n=0}^{+\infty} a^n z^{-n} = \frac{1}{1 - a z^{-1}} = \frac{z}{z - a}, \quad |z| > |a|
$$
可以看到，傅里叶变换是 Z 变换在 $z = e^{j\omega}$ 处的值。

### 10. **选择使用哪种变换**

- **傅里叶变换**适用于需要分析信号频谱特性、进行频率响应分析的场合。

- **Z 变换**则适用于更广泛的系统分析，包括稳定性分析、差分方程求解、滤波器设计等。由于 Z 变换包含傅里叶变换的信息，因此在需要更深入分析系统特性的情况下，Z 变换是更合适的选择。

### 11. **总结**

## 两种推广变换的比较
拉普拉斯变换和 Z 变换都可以被视为傅里叶变换的推广，但它们的推广方向不同，适用的对象也不同。因此，Z 变换相对于傅里叶变换的推广与拉普拉斯变换的推广在关键特征上有所区别。我们可以通过以下几个方面来对比和理解它们的不同推广方式。

### 1. **定义与对象的区别**

- **傅里叶变换**
  - 定义在**连续时间信号**或**离散时间信号**上。
  - 主要用于分析信号的频域特性，其频率变量是**纯虚数**（单位圆上，即 $e^{j\omega}$）。

- **拉普拉斯变换**
  - 是傅里叶变换在**连续时间**下的推广。
  - 处理的对象是**连续时间信号**，并且允许处理不稳定或非周期信号。
  - 拉普拉斯变换引入了复数域的 $s = \sigma + j\omega$，因此推广到整个复平面，处理不仅包含频率成分（傅里叶变换中的 $j\omega$ 部分），还可以处理信号的增长或衰减（通过实数部分 $\sigma$ 来表达）。

- **Z 变换**
  - 是傅里叶变换在**离散时间**下的推广。
  - 处理的对象是**离散时间信号**，即信号只在离散的时间点上有值。
  - Z 变换引入了复变量 $z$，并扩展到复平面，因此不仅处理频率信息（类似傅里叶变换单位圆上的频率响应），还可以描述信号的增长、衰减和系统的稳定性。

### 2. **复平面表示**

- **拉普拉斯变换**
  - 使用 $s = \sigma + j\omega$ 表示复平面上的点。傅里叶变换是拉普拉斯变换在实轴上的特例，当 $\sigma = 0$ 时，$s = j\omega$，这就是傅里叶变换。通过改变 $\sigma$，拉普拉斯变换可以处理信号的衰减或增长。

- **Z 变换**
  - 使用 $z = re^{j\omega}$ 表示复平面上的点。傅里叶变换是 Z 变换在单位圆上的特例，当 $|z| = 1$，即 $z = e^{j\omega}$，这时的 Z 变换就变成了傅里叶变换。通过改变 $|z|$，Z 变换可以分析信号的稳定性或增长、衰减行为。

### 3. **适用对象与时间特性**

- **拉普拉斯变换**：
  - 适用于**连续时间系统**。
  - 主要处理微分方程和连续时间信号的特性，尤其是稳定性分析、系统的瞬态和稳态响应。
  - 适合处理**非周期**和**非稳定**的信号。通过 $s = \sigma + j\omega$ 的实部 $\sigma$ 来分析信号是增长还是衰减。

- **Z 变换**：
  - 适用于**离散时间系统**。
  - 主要处理差分方程和离散时间信号，尤其是用于分析数字滤波器、离散控制系统的行为。
  - 适合处理离散时间下的信号，通过 $z = re^{j\omega}$ 的模 $r$ 来分析信号的增长或衰减，也可以判断系统的稳定性。

### 4. **傅里叶变换的推广方式**

- **拉普拉斯变换推广傅里叶变换**：
  - **时间域的推广**：傅里叶变换只适用于分析周期性或稳定信号，而拉普拉斯变换通过引入复数 $s$ 的实部来处理**非稳定或增长衰减的信号**，比如信号的指数增长或衰减。
  - **频域的推广**：傅里叶变换只在频率域上 $j\omega$ 进行分析，而拉普拉斯变换通过 $s = \sigma + j\omega$ 扩展到整个复平面，从而允许同时分析信号的频率成分和幅度变化（即指数增长或衰减）。

总体而言，拉普拉斯变换的推广着重于允许处理信号的**瞬态响应**、**增长衰减行为**，更广泛地适用于**非稳定的连续时间信号**。

- **Z 变换推广傅里叶变换**：
  - **时间域的推广**：傅里叶变换适用于离散信号的周期性频率分析，但 Z 变换通过引入复数 $z$，可以处理**离散时间信号的增长或衰减**，并分析**因果性**和**系统稳定性**等问题。
  - **频域的推广**：傅里叶变换在单位圆 $|z| = 1$ 上进行分析，而 Z 变换在整个复平面 $z = re^{j\omega}$ 上分析，允许通过 $|z|$ 的变化来研究离散时间系统的稳定性和极点位置。

Z 变换的推广重点在于**离散时间系统**的稳定性、信号的增益或衰减行为，应用于数字信号处理和离散控制系统中。

### 5. **收敛域与稳定性分析**

- **拉普拉斯变换**：
  - **收敛域**：拉普拉斯变换的收敛域是复平面中满足级数收敛的区域，通常取决于信号的特性和系统的极点位置。
  - **稳定性分析**：拉普拉斯变换通过观察系统极点的位置来判断系统稳定性。对于连续时间系统，如果系统的极点都位于复平面左半平面（$\sigma < 0$），系统是稳定的。

- **Z 变换**：
  - **收敛域**：Z 变换的收敛域是复平面中使得 Z 变换级数收敛的区域，取决于信号是否是因果信号或反因果信号。通过不同的 $|z|$ 区域可以判断信号的增长或衰减行为。
  - **稳定性分析**：Z 变换通过分析系统极点的位置来判断系统稳定性。如果系统的所有极点都位于单位圆内（即 $|z| < 1$），那么离散时间系统是稳定的。

### 6. **总结**

- **拉普拉斯变换**是傅里叶变换在**连续时间**系统上的推广，它通过引入 $s = \sigma + j\omega$ 的实部，允许处理非周期、非稳定信号。拉普拉斯变换广泛用于分析微分方程、控制系统和系统稳定性。

- **Z 变换**是傅里叶变换在**离散时间**系统上的推广，它通过引入 $z = re^{j\omega}$，允许处理离散时间信号的增长、衰减和系统稳定性分析。Z 变换主要用于差分方程求解、数字信号处理和离散系统的分析。

因此，**拉普拉斯变换的推广方向在于连续时间信号的非稳定性处理**，而**Z 变换的推广则在于离散时间系统的增益或衰减行为分析以及系统稳定性判断**。

